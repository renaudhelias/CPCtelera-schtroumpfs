                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.8 #9946 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module txt_scroll
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _scroll
                             12 	.globl _cpct_getScreenPtr
                             13 	.globl _cpct_drawSprite
                             14 ;--------------------------------------------------------
                             15 ; special function registers
                             16 ;--------------------------------------------------------
                             17 ;--------------------------------------------------------
                             18 ; ram data
                             19 ;--------------------------------------------------------
                             20 	.area _DATA
                             21 ;--------------------------------------------------------
                             22 ; ram data
                             23 ;--------------------------------------------------------
                             24 	.area _INITIALIZED
                             25 ;--------------------------------------------------------
                             26 ; absolute external ram data
                             27 ;--------------------------------------------------------
                             28 	.area _DABS (ABS)
                             29 ;--------------------------------------------------------
                             30 ; global & static initialisations
                             31 ;--------------------------------------------------------
                             32 	.area _HOME
                             33 	.area _GSINIT
                             34 	.area _GSFINAL
                             35 	.area _GSINIT
                             36 ;--------------------------------------------------------
                             37 ; Home
                             38 ;--------------------------------------------------------
                             39 	.area _HOME
                             40 	.area _HOME
                             41 ;--------------------------------------------------------
                             42 ; code
                             43 ;--------------------------------------------------------
                             44 	.area _CODE
                             45 ;src/txt_scroll.c:6: void scroll(char * texte, unsigned int l, unsigned int step) {
                             46 ;	---------------------------------
                             47 ; Function scroll
                             48 ; ---------------------------------
   0000                      49 _scroll::
   0000 DD E5         [15]   50 	push	ix
   0002 DD 21 00 00   [14]   51 	ld	ix,#0
   0006 DD 39         [15]   52 	add	ix,sp
   0008 F5            [11]   53 	push	af
   0009 F5            [11]   54 	push	af
   000A 3B            [ 6]   55 	dec	sp
                             56 ;src/txt_scroll.c:10: for(c=step;c<G_TILE_FONTMAP20X22_00_W*l;c=c+1) {
   000B DD 4E 08      [19]   57 	ld	c, 8 (ix)
   000E 41            [ 4]   58 	ld	b, c
   000F DD 5E 06      [19]   59 	ld	e,6 (ix)
   0012 DD 56 07      [19]   60 	ld	d,7 (ix)
   0015 6B            [ 4]   61 	ld	l, e
   0016 62            [ 4]   62 	ld	h, d
   0017 29            [11]   63 	add	hl, hl
   0018 29            [11]   64 	add	hl, hl
   0019 19            [11]   65 	add	hl, de
   001A 29            [11]   66 	add	hl, hl
   001B EB            [ 4]   67 	ex	de,hl
   001C                      68 00108$:
   001C 68            [ 4]   69 	ld	l, b
   001D 26 00         [ 7]   70 	ld	h, #0x00
   001F BF            [ 4]   71 	cp	a, a
   0020 ED 52         [15]   72 	sbc	hl, de
   0022 D2rCEr00      [10]   73 	jp	NC, 00110$
                             74 ;src/txt_scroll.c:11: if (c-step>SCREEN_WIDTH) {return;}
   0025 68            [ 4]   75 	ld	l, b
   0026 26 00         [ 7]   76 	ld	h, #0x00
   0028 7D            [ 4]   77 	ld	a, l
   0029 DD 96 08      [19]   78 	sub	a, 8 (ix)
   002C 6F            [ 4]   79 	ld	l, a
   002D 7C            [ 4]   80 	ld	a, h
   002E DD 9E 09      [19]   81 	sbc	a, 9 (ix)
   0031 67            [ 4]   82 	ld	h, a
   0032 3E A0         [ 7]   83 	ld	a, #0xa0
   0034 BD            [ 4]   84 	cp	a, l
   0035 3E 00         [ 7]   85 	ld	a, #0x00
   0037 9C            [ 4]   86 	sbc	a, h
   0038 DArCEr00      [10]   87 	jp	C,00110$
                             88 ;src/txt_scroll.c:12: if (texte[c]!=' ' && c%G_TILE_FONTMAP20X22_00_W==0) {
   003B DD 7E 04      [19]   89 	ld	a, 4 (ix)
   003E 80            [ 4]   90 	add	a, b
   003F 6F            [ 4]   91 	ld	l, a
   0040 DD 7E 05      [19]   92 	ld	a, 5 (ix)
   0043 CE 00         [ 7]   93 	adc	a, #0x00
   0045 67            [ 4]   94 	ld	h, a
   0046 7E            [ 7]   95 	ld	a, (hl)
   0047 D6 20         [ 7]   96 	sub	a, #0x20
   0049 CArCAr00      [10]   97 	jp	Z,00109$
   004C C5            [11]   98 	push	bc
   004D D5            [11]   99 	push	de
   004E 3E 0A         [ 7]  100 	ld	a, #0x0a
   0050 F5            [11]  101 	push	af
   0051 33            [ 6]  102 	inc	sp
   0052 C5            [11]  103 	push	bc
   0053 33            [ 6]  104 	inc	sp
   0054 CDr00r00      [17]  105 	call	__moduchar
   0057 F1            [10]  106 	pop	af
   0058 D1            [10]  107 	pop	de
   0059 C1            [10]  108 	pop	bc
   005A 7D            [ 4]  109 	ld	a, l
   005B B7            [ 4]  110 	or	a, a
   005C 20 6C         [12]  111 	jr	NZ,00109$
                            112 ;src/txt_scroll.c:13: o=texte[c/G_TILE_FONTMAP20X22_00_W]-'A';
   005E C5            [11]  113 	push	bc
   005F D5            [11]  114 	push	de
   0060 3E 0A         [ 7]  115 	ld	a, #0x0a
   0062 F5            [11]  116 	push	af
   0063 33            [ 6]  117 	inc	sp
   0064 C5            [11]  118 	push	bc
   0065 33            [ 6]  119 	inc	sp
   0066 CDr00r00      [17]  120 	call	__divuchar
   0069 F1            [10]  121 	pop	af
   006A DD 75 FF      [19]  122 	ld	-1 (ix), l
   006D D1            [10]  123 	pop	de
   006E C1            [10]  124 	pop	bc
   006F DD 7E 04      [19]  125 	ld	a, 4 (ix)
   0072 DD 86 FF      [19]  126 	add	a, -1 (ix)
   0075 6F            [ 4]  127 	ld	l, a
   0076 DD 7E 05      [19]  128 	ld	a, 5 (ix)
   0079 CE 00         [ 7]  129 	adc	a, #0x00
   007B 67            [ 4]  130 	ld	h, a
   007C 6E            [ 7]  131 	ld	l, (hl)
   007D 26 00         [ 7]  132 	ld	h, #0x00
   007F 7D            [ 4]  133 	ld	a, l
   0080 C6 BF         [ 7]  134 	add	a, #0xbf
   0082 DD 77 FB      [19]  135 	ld	-5 (ix), a
   0085 7C            [ 4]  136 	ld	a, h
   0086 CE FF         [ 7]  137 	adc	a, #0xff
   0088 DD 77 FC      [19]  138 	ld	-4 (ix), a
                            139 ;src/txt_scroll.c:14: p = cpct_getScreenPtr(CPCT_VMEM_START, c-step,120-1);
   008B 78            [ 4]  140 	ld	a, b
   008C 91            [ 4]  141 	sub	a, c
   008D 67            [ 4]  142 	ld	h, a
   008E C5            [11]  143 	push	bc
   008F D5            [11]  144 	push	de
   0090 3E 77         [ 7]  145 	ld	a, #0x77
   0092 F5            [11]  146 	push	af
   0093 33            [ 6]  147 	inc	sp
   0094 E5            [11]  148 	push	hl
   0095 33            [ 6]  149 	inc	sp
   0096 21 00 C0      [10]  150 	ld	hl, #0xc000
   0099 E5            [11]  151 	push	hl
   009A CDr00r00      [17]  152 	call	_cpct_getScreenPtr
   009D D1            [10]  153 	pop	de
   009E C1            [10]  154 	pop	bc
                            155 ;src/txt_scroll.c:15: cpct_drawSprite(g_tile_tileset[o], p, G_TILE_FONTMAP20X22_00_W, G_TILE_FONTMAP20X22_00_H);
   009F E5            [11]  156 	push	hl
   00A0 FD E1         [14]  157 	pop	iy
   00A2 E1            [10]  158 	pop	hl
   00A3 E5            [11]  159 	push	hl
   00A4 29            [11]  160 	add	hl, hl
   00A5 3Er00         [ 7]  161 	ld	a, #<(_g_tile_tileset)
   00A7 85            [ 4]  162 	add	a, l
   00A8 6F            [ 4]  163 	ld	l, a
   00A9 3Es00         [ 7]  164 	ld	a, #>(_g_tile_tileset)
   00AB 8C            [ 4]  165 	adc	a, h
   00AC 67            [ 4]  166 	ld	h, a
   00AD 7E            [ 7]  167 	ld	a, (hl)
   00AE 23            [ 6]  168 	inc	hl
   00AF 66            [ 7]  169 	ld	h, (hl)
   00B0 DD 77 FD      [19]  170 	ld	-3 (ix), a
   00B3 DD 74 FE      [19]  171 	ld	-2 (ix), h
   00B6 C5            [11]  172 	push	bc
   00B7 D5            [11]  173 	push	de
   00B8 21 0A 16      [10]  174 	ld	hl, #0x160a
   00BB E5            [11]  175 	push	hl
   00BC FD E5         [15]  176 	push	iy
   00BE DD 6E FD      [19]  177 	ld	l,-3 (ix)
   00C1 DD 66 FE      [19]  178 	ld	h,-2 (ix)
   00C4 E5            [11]  179 	push	hl
   00C5 CDr00r00      [17]  180 	call	_cpct_drawSprite
   00C8 D1            [10]  181 	pop	de
   00C9 C1            [10]  182 	pop	bc
   00CA                     183 00109$:
                            184 ;src/txt_scroll.c:10: for(c=step;c<G_TILE_FONTMAP20X22_00_W*l;c=c+1) {
   00CA 04            [ 4]  185 	inc	b
   00CB C3r1Cr00      [10]  186 	jp	00108$
   00CE                     187 00110$:
   00CE DD F9         [10]  188 	ld	sp, ix
   00D0 DD E1         [14]  189 	pop	ix
   00D2 C9            [10]  190 	ret
                            191 	.area _CODE
                            192 	.area _INITIALIZER
                            193 	.area _CABS (ABS)
