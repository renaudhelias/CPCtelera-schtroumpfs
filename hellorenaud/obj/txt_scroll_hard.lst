                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.8 #9946 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module txt_scroll_hard
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _scroll_hard
                             12 	.globl _draw_char
                             13 	.globl _texte
                             14 ;--------------------------------------------------------
                             15 ; special function registers
                             16 ;--------------------------------------------------------
                             17 ;--------------------------------------------------------
                             18 ; ram data
                             19 ;--------------------------------------------------------
                             20 	.area _DATA
                             21 ;--------------------------------------------------------
                             22 ; ram data
                             23 ;--------------------------------------------------------
                             24 	.area _INITIALIZED
                             25 ;--------------------------------------------------------
                             26 ; absolute external ram data
                             27 ;--------------------------------------------------------
                             28 	.area _DABS (ABS)
                             29 ;--------------------------------------------------------
                             30 ; global & static initialisations
                             31 ;--------------------------------------------------------
                             32 	.area _HOME
                             33 	.area _GSINIT
                             34 	.area _GSFINAL
                             35 	.area _GSINIT
                             36 ;--------------------------------------------------------
                             37 ; Home
                             38 ;--------------------------------------------------------
                             39 	.area _HOME
                             40 	.area _HOME
                             41 ;--------------------------------------------------------
                             42 ; code
                             43 ;--------------------------------------------------------
                             44 	.area _CODE
                             45 ;src/txt_scroll_hard.c:13: void draw_char(u8 c, u8* image, u8* plot) {
                             46 ;	---------------------------------
                             47 ; Function draw_char
                             48 ; ---------------------------------
   0000                      49 _draw_char::
   0000 DD E5         [15]   50 	push	ix
   0002 DD 21 00 00   [14]   51 	ld	ix,#0
   0006 DD 39         [15]   52 	add	ix,sp
   0008 F5            [11]   53 	push	af
   0009 F5            [11]   54 	push	af
                             55 ;src/txt_scroll_hard.c:20: last_plot=plot+ 0x4000 +80u*c+ 0x3801;
   000A DD 4E 04      [19]   56 	ld	c, 4 (ix)
   000D 06 00         [ 7]   57 	ld	b, #0x00
   000F 69            [ 4]   58 	ld	l, c
   0010 60            [ 4]   59 	ld	h, b
   0011 29            [11]   60 	add	hl, hl
   0012 29            [11]   61 	add	hl, hl
   0013 09            [11]   62 	add	hl, bc
   0014 29            [11]   63 	add	hl, hl
   0015 29            [11]   64 	add	hl, hl
   0016 29            [11]   65 	add	hl, hl
   0017 29            [11]   66 	add	hl, hl
   0018 4D            [ 4]   67 	ld	c, l
   0019 44            [ 4]   68 	ld	b, h
   001A 21 01 78      [10]   69 	ld	hl, #0x7801
   001D 09            [11]   70 	add	hl,bc
   001E EB            [ 4]   71 	ex	de,hl
   001F DD 6E 07      [19]   72 	ld	l,7 (ix)
   0022 DD 66 08      [19]   73 	ld	h,8 (ix)
   0025 19            [11]   74 	add	hl, de
   0026 54            [ 4]   75 	ld	d, h
                             76 ;src/txt_scroll_hard.c:21: if (last_plot<0x4000) {
                             77 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   0027 DD 7E 07      [19]   78 	ld	a, 7 (ix)
   002A C6 00         [ 7]   79 	add	a, #0x00
   002C 6F            [ 4]   80 	ld	l, a
   002D DD 7E 08      [19]   81 	ld	a, 8 (ix)
   0030 CE 40         [ 7]   82 	adc	a, #0x40
   0032 67            [ 4]   83 	ld	h, a
   0033 09            [11]   84 	add	hl,bc
   0034 4D            [ 4]   85 	ld	c, l
   0035 44            [ 4]   86 	ld	b, h
                             87 ;src/txt_scroll_hard.c:21: if (last_plot<0x4000) {
   0036 7A            [ 4]   88 	ld	a, d
   0037 D6 40         [ 7]   89 	sub	a, #0x40
   0039 30 40         [12]   90 	jr	NC,00129$
                             91 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   003B DD 36 FC 00   [19]   92 	ld	-4 (ix), #0x00
                             93 ;src/txt_scroll_hard.c:23: for (x=0;x<2;x++) {
   003F                      94 00123$:
   003F DD 36 FD 00   [19]   95 	ld	-3 (ix), #0x00
   0043                      96 00111$:
                             97 ;src/txt_scroll_hard.c:24: cur_plot=plot+ 0x4000 +80u*c+ ((y % 8u) * 2048u) + x;
   0043 DD 7E FC      [19]   98 	ld	a, -4 (ix)
   0046 E6 07         [ 7]   99 	and	a, #0x07
   0048 07            [ 4]  100 	rlca
   0049 07            [ 4]  101 	rlca
   004A 07            [ 4]  102 	rlca
   004B E6 F8         [ 7]  103 	and	a, #0xf8
   004D 67            [ 4]  104 	ld	h, a
   004E 2E 00         [ 7]  105 	ld	l, #0x00
   0050 09            [11]  106 	add	hl, bc
   0051 DD 5E FD      [19]  107 	ld	e,-3 (ix)
   0054 16 00         [ 7]  108 	ld	d,#0x00
   0056 19            [11]  109 	add	hl, de
                            110 ;src/txt_scroll_hard.c:26: if (cur_plot<0x4000) {
                            111 ;src/txt_scroll_hard.c:27: cur_plot=cur_plot-0x4000;
   0057 7C            [ 4]  112 	ld	a,h
   0058 FE 40         [ 7]  113 	cp	a,#0x40
   005A 30 07         [12]  114 	jr	NC,00102$
   005C C6 C0         [ 7]  115 	add	a,#0xc0
   005E 67            [ 4]  116 	ld	h, a
                            117 ;src/txt_scroll_hard.c:29: *cur_plot=0xF0;
   005F 36 F0         [10]  118 	ld	(hl), #0xf0
   0061 18 02         [12]  119 	jr	00112$
   0063                     120 00102$:
                            121 ;src/txt_scroll_hard.c:31: *cur_plot=0xFF;
   0063 36 FF         [10]  122 	ld	(hl), #0xff
   0065                     123 00112$:
                            124 ;src/txt_scroll_hard.c:23: for (x=0;x<2;x++) {
   0065 DD 34 FD      [23]  125 	inc	-3 (ix)
   0068 DD 7E FD      [19]  126 	ld	a, -3 (ix)
   006B D6 02         [ 7]  127 	sub	a, #0x02
   006D 38 D4         [12]  128 	jr	C,00111$
                            129 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   006F DD 34 FC      [23]  130 	inc	-4 (ix)
   0072 DD 7E FC      [19]  131 	ld	a, -4 (ix)
   0075 D6 08         [ 7]  132 	sub	a, #0x08
   0077 38 C6         [12]  133 	jr	C,00123$
   0079 18 5C         [12]  134 	jr	00119$
                            135 ;src/txt_scroll_hard.c:36: for (y=0;y<8;y++) {
   007B                     136 00129$:
   007B DD 36 FC 00   [19]  137 	ld	-4 (ix), #0x00
                            138 ;src/txt_scroll_hard.c:37: for (x=0;x<2;x++) {
   007F                     139 00127$:
   007F DD 36 FD 00   [19]  140 	ld	-3 (ix), #0x00
   0083                     141 00115$:
                            142 ;src/txt_scroll_hard.c:38: cur_plot=plot+ 0x4000 +80u*c+ ((y % 8u) * 2048u) + x;
   0083 DD 7E FC      [19]  143 	ld	a, -4 (ix)
   0086 E6 07         [ 7]  144 	and	a, #0x07
   0088 07            [ 4]  145 	rlca
   0089 07            [ 4]  146 	rlca
   008A 07            [ 4]  147 	rlca
   008B E6 F8         [ 7]  148 	and	a, #0xf8
   008D 67            [ 4]  149 	ld	h, a
   008E 2E 00         [ 7]  150 	ld	l, #0x00
   0090 09            [11]  151 	add	hl, bc
   0091 7D            [ 4]  152 	ld	a, l
   0092 DD 86 FD      [19]  153 	add	a, -3 (ix)
   0095 DD 77 FE      [19]  154 	ld	-2 (ix), a
   0098 7C            [ 4]  155 	ld	a, h
   0099 CE 00         [ 7]  156 	adc	a, #0x00
   009B DD 77 FF      [19]  157 	ld	-1 (ix), a
                            158 ;src/txt_scroll_hard.c:39: cur_image=image+(c*8+y)*2+x;
   009E DD 6E 04      [19]  159 	ld	l, 4 (ix)
   00A1 26 00         [ 7]  160 	ld	h, #0x00
   00A3 29            [11]  161 	add	hl, hl
   00A4 29            [11]  162 	add	hl, hl
   00A5 29            [11]  163 	add	hl, hl
   00A6 DD 5E FC      [19]  164 	ld	e, -4 (ix)
   00A9 16 00         [ 7]  165 	ld	d, #0x00
   00AB 19            [11]  166 	add	hl, de
   00AC 29            [11]  167 	add	hl, hl
   00AD EB            [ 4]  168 	ex	de,hl
   00AE DD 6E 05      [19]  169 	ld	l,5 (ix)
   00B1 DD 66 06      [19]  170 	ld	h,6 (ix)
   00B4 19            [11]  171 	add	hl, de
   00B5 DD 5E FD      [19]  172 	ld	e,-3 (ix)
   00B8 16 00         [ 7]  173 	ld	d,#0x00
   00BA 19            [11]  174 	add	hl, de
                            175 ;src/txt_scroll_hard.c:40: *cur_plot=*cur_image;
   00BB 5E            [ 7]  176 	ld	e, (hl)
   00BC DD 6E FE      [19]  177 	ld	l,-2 (ix)
   00BF DD 66 FF      [19]  178 	ld	h,-1 (ix)
   00C2 73            [ 7]  179 	ld	(hl), e
                            180 ;src/txt_scroll_hard.c:37: for (x=0;x<2;x++) {
   00C3 DD 34 FD      [23]  181 	inc	-3 (ix)
   00C6 DD 7E FD      [19]  182 	ld	a, -3 (ix)
   00C9 D6 02         [ 7]  183 	sub	a, #0x02
   00CB 38 B6         [12]  184 	jr	C,00115$
                            185 ;src/txt_scroll_hard.c:36: for (y=0;y<8;y++) {
   00CD DD 34 FC      [23]  186 	inc	-4 (ix)
   00D0 DD 7E FC      [19]  187 	ld	a, -4 (ix)
   00D3 D6 08         [ 7]  188 	sub	a, #0x08
   00D5 38 A8         [12]  189 	jr	C,00127$
   00D7                     190 00119$:
   00D7 DD F9         [10]  191 	ld	sp, ix
   00D9 DD E1         [14]  192 	pop	ix
   00DB C9            [10]  193 	ret
                            194 ;src/txt_scroll_hard.c:90: void scroll_hard(u16 step, u8* screen_plot_address) {
                            195 ;	---------------------------------
                            196 ; Function scroll_hard
                            197 ; ---------------------------------
   00DC                     198 _scroll_hard::
   00DC DD E5         [15]  199 	push	ix
   00DE DD 21 00 00   [14]  200 	ld	ix,#0
   00E2 DD 39         [15]  201 	add	ix,sp
   00E4 F5            [11]  202 	push	af
                            203 ;src/txt_scroll_hard.c:96: u8* plot=screen_plot_address;
   00E5 DD 4E 06      [19]  204 	ld	c,6 (ix)
   00E8 DD 46 07      [19]  205 	ld	b,7 (ix)
                            206 ;src/txt_scroll_hard.c:99: div=step/8;
   00EB DD 5E 04      [19]  207 	ld	e,4 (ix)
   00EE DD 56 05      [19]  208 	ld	d,5 (ix)
   00F1 CB 3A         [ 8]  209 	srl	d
   00F3 CB 1B         [ 8]  210 	rr	e
   00F5 CB 3A         [ 8]  211 	srl	d
   00F7 CB 1B         [ 8]  212 	rr	e
   00F9 CB 3A         [ 8]  213 	srl	d
   00FB CB 1B         [ 8]  214 	rr	e
                            215 ;src/txt_scroll_hard.c:100: mod=step%8;
   00FD DD 7E 04      [19]  216 	ld	a, 4 (ix)
   0100 E6 07         [ 7]  217 	and	a, #0x07
   0102 DD 77 FE      [19]  218 	ld	-2 (ix), a
   0105 DD 36 FF 00   [19]  219 	ld	-1 (ix), #0x00
                            220 ;src/txt_scroll_hard.c:101: div=div%128;
   0109 CB BB         [ 8]  221 	res	7, e
   010B 16 00         [ 7]  222 	ld	d, #0x00
                            223 ;src/txt_scroll_hard.c:102: if (texte[div]==' ') {
   010D 21r75r01      [10]  224 	ld	hl, #_texte+0
   0110 19            [11]  225 	add	hl, de
   0111 5E            [ 7]  226 	ld	e, (hl)
   0112 7B            [ 4]  227 	ld	a, e
   0113 D6 20         [ 7]  228 	sub	a, #0x20
   0115 20 05         [12]  229 	jr	NZ,00102$
                            230 ;src/txt_scroll_hard.c:103: o=0;
   0117 11 00 00      [10]  231 	ld	de, #0x0000
   011A 18 09         [12]  232 	jr	00103$
   011C                     233 00102$:
                            234 ;src/txt_scroll_hard.c:105: o=texte[div]-'?';
   011C 16 00         [ 7]  235 	ld	d, #0x00
   011E 7B            [ 4]  236 	ld	a, e
   011F C6 C1         [ 7]  237 	add	a, #0xc1
   0121 5F            [ 4]  238 	ld	e, a
   0122 7A            [ 4]  239 	ld	a, d
   0123 CE FF         [ 7]  240 	adc	a, #0xff
   0125                     241 00103$:
                            242 ;src/txt_scroll_hard.c:108: pointeur=(u16)g_tile_fontmap32x32plat_000+o*8*(32*2)+mod*(32*2);
   0125 21r00r00      [10]  243 	ld	hl, #_g_tile_fontmap32x32plat_000
   0128 7B            [ 4]  244 	ld	a, e
   0129 87            [ 4]  245 	add	a, a
   012A 57            [ 4]  246 	ld	d, a
   012B 1E 00         [ 7]  247 	ld	e, #0x00
   012D 19            [11]  248 	add	hl,de
   012E EB            [ 4]  249 	ex	de,hl
   012F E1            [10]  250 	pop	hl
   0130 E5            [11]  251 	push	hl
   0131 29            [11]  252 	add	hl, hl
   0132 29            [11]  253 	add	hl, hl
   0133 29            [11]  254 	add	hl, hl
   0134 29            [11]  255 	add	hl, hl
   0135 29            [11]  256 	add	hl, hl
   0136 29            [11]  257 	add	hl, hl
   0137 19            [11]  258 	add	hl, de
                            259 ;src/txt_scroll_hard.c:112: draw_char(0,(u8*)pointeur, plot);
   0138 E5            [11]  260 	push	hl
   0139 C5            [11]  261 	push	bc
   013A C5            [11]  262 	push	bc
   013B E5            [11]  263 	push	hl
   013C AF            [ 4]  264 	xor	a, a
   013D F5            [11]  265 	push	af
   013E 33            [ 6]  266 	inc	sp
   013F CDr00r00      [17]  267 	call	_draw_char
   0142 F1            [10]  268 	pop	af
   0143 F1            [10]  269 	pop	af
   0144 33            [ 6]  270 	inc	sp
   0145 C1            [10]  271 	pop	bc
   0146 E1            [10]  272 	pop	hl
                            273 ;src/txt_scroll_hard.c:113: draw_char(1,(u8*)pointeur, plot);
   0147 E5            [11]  274 	push	hl
   0148 C5            [11]  275 	push	bc
   0149 C5            [11]  276 	push	bc
   014A E5            [11]  277 	push	hl
   014B 3E 01         [ 7]  278 	ld	a, #0x01
   014D F5            [11]  279 	push	af
   014E 33            [ 6]  280 	inc	sp
   014F CDr00r00      [17]  281 	call	_draw_char
   0152 F1            [10]  282 	pop	af
   0153 F1            [10]  283 	pop	af
   0154 33            [ 6]  284 	inc	sp
   0155 C1            [10]  285 	pop	bc
   0156 E1            [10]  286 	pop	hl
                            287 ;src/txt_scroll_hard.c:114: draw_char(2,(u8*)pointeur, plot);
   0157 E5            [11]  288 	push	hl
   0158 C5            [11]  289 	push	bc
   0159 C5            [11]  290 	push	bc
   015A E5            [11]  291 	push	hl
   015B 3E 02         [ 7]  292 	ld	a, #0x02
   015D F5            [11]  293 	push	af
   015E 33            [ 6]  294 	inc	sp
   015F CDr00r00      [17]  295 	call	_draw_char
   0162 F1            [10]  296 	pop	af
   0163 F1            [10]  297 	pop	af
   0164 33            [ 6]  298 	inc	sp
   0165 C1            [10]  299 	pop	bc
   0166 E1            [10]  300 	pop	hl
                            301 ;src/txt_scroll_hard.c:115: draw_char(3,(u8*)pointeur, plot);
   0167 C5            [11]  302 	push	bc
   0168 E5            [11]  303 	push	hl
   0169 3E 03         [ 7]  304 	ld	a, #0x03
   016B F5            [11]  305 	push	af
   016C 33            [ 6]  306 	inc	sp
   016D CDr00r00      [17]  307 	call	_draw_char
   0170 DD F9         [10]  308 	ld	sp,ix
   0172 DD E1         [14]  309 	pop	ix
   0174 C9            [10]  310 	ret
   0175                     311 _texte:
   0175 57 45 20 57 49 53   312 	.ascii "WE WISH YOU A MERRY CHRISTMAS WE WISH YOU A MERRY CHRISTMAS "
        48 20 59 4F 55 20
        41 20 4D 45 52 52
        59 20 43 48 52 49
        53 54 4D 41 53 20
        57 45 20 57 49 53
        48 20 59 4F 55 20
        41 20 4D 45 52 52
        59 20 43 48 52 49
        53 54 4D 41 53 20
   01B1 41 4E 44 20 41 20   313 	.ascii "AND A HAPPY NEW YEAR FROM THSF AND TETALAB      AZERTYUIOPQS"
        48 41 50 50 59 20
        4E 45 57 20 59 45
        41 52 20 46 52 4F
        4D 20 54 48 53 46
        20 41 4E 44 20 54
        45 54 41 4C 41 42
        20 20 20 20 20 20
        41 5A 45 52 54 59
        55 49 4F 50 51 53
   01ED 44 46 47 20 20 20   314 	.ascii "DFG     "
        20 20
   01F5 00                  315 	.db 0x00
   01F6 00                  316 	.db 0x00
                            317 	.area _CODE
                            318 	.area _INITIALIZER
                            319 	.area _CABS (ABS)
