                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.8 #9946 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module txt_scroll_hard
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _scroll_hard
                             12 	.globl _draw_char
                             13 	.globl _texte
                             14 ;--------------------------------------------------------
                             15 ; special function registers
                             16 ;--------------------------------------------------------
                             17 ;--------------------------------------------------------
                             18 ; ram data
                             19 ;--------------------------------------------------------
                             20 	.area _DATA
                             21 ;--------------------------------------------------------
                             22 ; ram data
                             23 ;--------------------------------------------------------
                             24 	.area _INITIALIZED
                             25 ;--------------------------------------------------------
                             26 ; absolute external ram data
                             27 ;--------------------------------------------------------
                             28 	.area _DABS (ABS)
                             29 ;--------------------------------------------------------
                             30 ; global & static initialisations
                             31 ;--------------------------------------------------------
                             32 	.area _HOME
                             33 	.area _GSINIT
                             34 	.area _GSFINAL
                             35 	.area _GSINIT
                             36 ;--------------------------------------------------------
                             37 ; Home
                             38 ;--------------------------------------------------------
                             39 	.area _HOME
                             40 	.area _HOME
                             41 ;--------------------------------------------------------
                             42 ; code
                             43 ;--------------------------------------------------------
                             44 	.area _CODE
                             45 ;src/txt_scroll_hard.c:13: void draw_char(u8 c, u8* image, u8* plot) {
                             46 ;	---------------------------------
                             47 ; Function draw_char
                             48 ; ---------------------------------
   0000                      49 _draw_char::
   0000 DD E5         [15]   50 	push	ix
   0002 DD 21 00 00   [14]   51 	ld	ix,#0
   0006 DD 39         [15]   52 	add	ix,sp
   0008 21 F4 FF      [10]   53 	ld	hl, #-12
   000B 39            [11]   54 	add	hl, sp
   000C F9            [ 6]   55 	ld	sp, hl
                             56 ;src/txt_scroll_hard.c:20: last_plot=plot+ 0x4000 +80u*c+ 0x3801;
   000D DD 4E 04      [19]   57 	ld	c, 4 (ix)
   0010 06 00         [ 7]   58 	ld	b, #0x00
   0012 69            [ 4]   59 	ld	l, c
   0013 60            [ 4]   60 	ld	h, b
   0014 29            [11]   61 	add	hl, hl
   0015 29            [11]   62 	add	hl, hl
   0016 09            [11]   63 	add	hl, bc
   0017 29            [11]   64 	add	hl, hl
   0018 29            [11]   65 	add	hl, hl
   0019 29            [11]   66 	add	hl, hl
   001A 29            [11]   67 	add	hl, hl
   001B 4D            [ 4]   68 	ld	c, l
   001C 44            [ 4]   69 	ld	b, h
   001D 21 01 78      [10]   70 	ld	hl, #0x7801
   0020 09            [11]   71 	add	hl,bc
   0021 EB            [ 4]   72 	ex	de,hl
   0022 DD 6E 07      [19]   73 	ld	l,7 (ix)
   0025 DD 66 08      [19]   74 	ld	h,8 (ix)
   0028 19            [11]   75 	add	hl, de
                             76 ;src/txt_scroll_hard.c:21: if (last_plot<0x4000) {
   0029 DD 75 F6      [19]   77 	ld	-10 (ix), l
   002C DD 74 F7      [19]   78 	ld	-9 (ix), h
                             79 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   002F DD 7E 07      [19]   80 	ld	a, 7 (ix)
   0032 C6 00         [ 7]   81 	add	a, #0x00
   0034 5F            [ 4]   82 	ld	e, a
   0035 DD 7E 08      [19]   83 	ld	a, 8 (ix)
   0038 CE 40         [ 7]   84 	adc	a, #0x40
   003A 57            [ 4]   85 	ld	d, a
                             86 ;src/txt_scroll_hard.c:25: cur_image=image+(c*8+((y+1)%8))*2+x;
   003B DD 6E 04      [19]   87 	ld	l, 4 (ix)
   003E 26 00         [ 7]   88 	ld	h, #0x00
                             89 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   0040 7B            [ 4]   90 	ld	a, e
   0041 81            [ 4]   91 	add	a, c
   0042 DD 77 FE      [19]   92 	ld	-2 (ix), a
   0045 7A            [ 4]   93 	ld	a, d
   0046 88            [ 4]   94 	adc	a, b
   0047 DD 77 FF      [19]   95 	ld	-1 (ix), a
                             96 ;src/txt_scroll_hard.c:25: cur_image=image+(c*8+((y+1)%8))*2+x;
   004A 29            [11]   97 	add	hl, hl
   004B 29            [11]   98 	add	hl, hl
   004C 29            [11]   99 	add	hl, hl
   004D DD 75 F8      [19]  100 	ld	-8 (ix), l
   0050 DD 74 F9      [19]  101 	ld	-7 (ix), h
                            102 ;src/txt_scroll_hard.c:21: if (last_plot<0x4000) {
   0053 DD 7E F7      [19]  103 	ld	a, -9 (ix)
   0056 D6 40         [ 7]  104 	sub	a, #0x40
   0058 D2rFBr00      [10]  105 	jp	NC, 00128$
                            106 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   005B DD 7E FE      [19]  107 	ld	a, -2 (ix)
   005E DD 77 F6      [19]  108 	ld	-10 (ix), a
   0061 DD 7E FF      [19]  109 	ld	a, -1 (ix)
   0064 DD 77 F7      [19]  110 	ld	-9 (ix), a
   0067 DD 36 F4 00   [19]  111 	ld	-12 (ix), #0x00
                            112 ;src/txt_scroll_hard.c:23: for (x=0;x<2;x++) {
   006B                     113 00122$:
   006B DD 36 F5 00   [19]  114 	ld	-11 (ix), #0x00
   006F                     115 00110$:
                            116 ;src/txt_scroll_hard.c:24: cur_plot=plot+ 0x4000 +80u*c+ ((y % 8u) * 2048u) + x;
   006F DD 7E F4      [19]  117 	ld	a, -12 (ix)
   0072 E6 07         [ 7]  118 	and	a, #0x07
   0074 07            [ 4]  119 	rlca
   0075 07            [ 4]  120 	rlca
   0076 07            [ 4]  121 	rlca
   0077 E6 F8         [ 7]  122 	and	a, #0xf8
   0079 57            [ 4]  123 	ld	d, a
   007A 1E 00         [ 7]  124 	ld	e, #0x00
   007C DD 6E F6      [19]  125 	ld	l,-10 (ix)
   007F DD 66 F7      [19]  126 	ld	h,-9 (ix)
   0082 19            [11]  127 	add	hl, de
   0083 7D            [ 4]  128 	ld	a, l
   0084 DD 86 F5      [19]  129 	add	a, -11 (ix)
   0087 DD 77 FC      [19]  130 	ld	-4 (ix), a
   008A 7C            [ 4]  131 	ld	a, h
   008B CE 00         [ 7]  132 	adc	a, #0x00
   008D DD 77 FD      [19]  133 	ld	-3 (ix), a
                            134 ;src/txt_scroll_hard.c:25: cur_image=image+(c*8+((y+1)%8))*2+x;
   0090 DD 4E F4      [19]  135 	ld	c, -12 (ix)
   0093 06 00         [ 7]  136 	ld	b, #0x00
   0095 03            [ 6]  137 	inc	bc
   0096 21 08 00      [10]  138 	ld	hl, #0x0008
   0099 E5            [11]  139 	push	hl
   009A C5            [11]  140 	push	bc
   009B CDr00r00      [17]  141 	call	__modsint
   009E F1            [10]  142 	pop	af
   009F F1            [10]  143 	pop	af
   00A0 DD 5E F8      [19]  144 	ld	e,-8 (ix)
   00A3 DD 56 F9      [19]  145 	ld	d,-7 (ix)
   00A6 19            [11]  146 	add	hl, de
   00A7 29            [11]  147 	add	hl, hl
   00A8 4D            [ 4]  148 	ld	c, l
   00A9 44            [ 4]  149 	ld	b, h
   00AA DD 6E 05      [19]  150 	ld	l,5 (ix)
   00AD DD 66 06      [19]  151 	ld	h,6 (ix)
   00B0 09            [11]  152 	add	hl, bc
   00B1 DD 7E F5      [19]  153 	ld	a, -11 (ix)
   00B4 85            [ 4]  154 	add	a, l
   00B5 DD 77 FA      [19]  155 	ld	-6 (ix), a
   00B8 3E 00         [ 7]  156 	ld	a, #0x00
   00BA 8C            [ 4]  157 	adc	a, h
   00BB DD 77 FB      [19]  158 	ld	-5 (ix), a
                            159 ;src/txt_scroll_hard.c:27: if (cur_plot<0x4000) {
   00BE DD 7E FD      [19]  160 	ld	a, -3 (ix)
   00C1 D6 40         [ 7]  161 	sub	a, #0x40
   00C3 30 10         [12]  162 	jr	NC,00102$
                            163 ;src/txt_scroll_hard.c:28: cur_plot=cur_plot-0x4000;
   00C5 DD 7E FC      [19]  164 	ld	a, -4 (ix)
   00C8 C6 00         [ 7]  165 	add	a, #0x00
   00CA DD 77 FC      [19]  166 	ld	-4 (ix), a
   00CD DD 7E FD      [19]  167 	ld	a, -3 (ix)
   00D0 CE C0         [ 7]  168 	adc	a, #0xc0
   00D2 DD 77 FD      [19]  169 	ld	-3 (ix), a
   00D5                     170 00102$:
                            171 ;src/txt_scroll_hard.c:30: *cur_plot=*cur_image;
   00D5 DD 6E FA      [19]  172 	ld	l,-6 (ix)
   00D8 DD 66 FB      [19]  173 	ld	h,-5 (ix)
   00DB 4E            [ 7]  174 	ld	c, (hl)
   00DC DD 6E FC      [19]  175 	ld	l,-4 (ix)
   00DF DD 66 FD      [19]  176 	ld	h,-3 (ix)
   00E2 71            [ 7]  177 	ld	(hl), c
                            178 ;src/txt_scroll_hard.c:23: for (x=0;x<2;x++) {
   00E3 DD 34 F5      [23]  179 	inc	-11 (ix)
   00E6 DD 7E F5      [19]  180 	ld	a, -11 (ix)
   00E9 D6 02         [ 7]  181 	sub	a, #0x02
   00EB DAr6Fr00      [10]  182 	jp	C, 00110$
                            183 ;src/txt_scroll_hard.c:22: for (y=0;y<8;y++) {
   00EE DD 34 F4      [23]  184 	inc	-12 (ix)
   00F1 DD 7E F4      [19]  185 	ld	a, -12 (ix)
   00F4 D6 08         [ 7]  186 	sub	a, #0x08
   00F6 DAr6Br00      [10]  187 	jp	C, 00122$
   00F9 18 5E         [12]  188 	jr	00118$
                            189 ;src/txt_scroll_hard.c:34: for (y=0;y<8;y++) {
   00FB                     190 00128$:
   00FB DD 7E FE      [19]  191 	ld	a, -2 (ix)
   00FE DD 77 FA      [19]  192 	ld	-6 (ix), a
   0101 DD 7E FF      [19]  193 	ld	a, -1 (ix)
   0104 DD 77 FB      [19]  194 	ld	-5 (ix), a
   0107 0E 00         [ 7]  195 	ld	c, #0x00
                            196 ;src/txt_scroll_hard.c:35: for (x=0;x<2;x++) {
   0109                     197 00126$:
   0109 06 00         [ 7]  198 	ld	b, #0x00
   010B                     199 00114$:
                            200 ;src/txt_scroll_hard.c:36: cur_plot=plot+ 0x4000 +80u*c+ ((y % 8u) * 2048u) + x;
   010B 79            [ 4]  201 	ld	a, c
   010C E6 07         [ 7]  202 	and	a, #0x07
   010E 07            [ 4]  203 	rlca
   010F 07            [ 4]  204 	rlca
   0110 07            [ 4]  205 	rlca
   0111 E6 F8         [ 7]  206 	and	a, #0xf8
   0113 57            [ 4]  207 	ld	d, a
   0114 1E 00         [ 7]  208 	ld	e, #0x00
   0116 DD 6E FA      [19]  209 	ld	l,-6 (ix)
   0119 DD 66 FB      [19]  210 	ld	h,-5 (ix)
   011C 19            [11]  211 	add	hl, de
   011D 58            [ 4]  212 	ld	e,b
   011E 16 00         [ 7]  213 	ld	d,#0x00
   0120 19            [11]  214 	add	hl, de
   0121 EB            [ 4]  215 	ex	de,hl
                            216 ;src/txt_scroll_hard.c:37: cur_image=image+(c*8+y)*2+x;
   0122 69            [ 4]  217 	ld	l, c
   0123 26 00         [ 7]  218 	ld	h, #0x00
   0125 DD 7E F8      [19]  219 	ld	a, -8 (ix)
   0128 85            [ 4]  220 	add	a, l
   0129 6F            [ 4]  221 	ld	l, a
   012A DD 7E F9      [19]  222 	ld	a, -7 (ix)
   012D 8C            [ 4]  223 	adc	a, h
   012E 67            [ 4]  224 	ld	h, a
   012F 29            [11]  225 	add	hl, hl
   0130 DD 75 FC      [19]  226 	ld	-4 (ix), l
   0133 DD 74 FD      [19]  227 	ld	-3 (ix), h
   0136 DD 7E 05      [19]  228 	ld	a, 5 (ix)
   0139 DD 86 FC      [19]  229 	add	a, -4 (ix)
   013C 6F            [ 4]  230 	ld	l, a
   013D DD 7E 06      [19]  231 	ld	a, 6 (ix)
   0140 DD 8E FD      [19]  232 	adc	a, -3 (ix)
   0143 67            [ 4]  233 	ld	h, a
   0144 7D            [ 4]  234 	ld	a, l
   0145 80            [ 4]  235 	add	a, b
   0146 6F            [ 4]  236 	ld	l, a
   0147 7C            [ 4]  237 	ld	a, h
   0148 CE 00         [ 7]  238 	adc	a, #0x00
   014A 67            [ 4]  239 	ld	h, a
                            240 ;src/txt_scroll_hard.c:38: *cur_plot=*cur_image;
   014B 7E            [ 7]  241 	ld	a, (hl)
   014C 12            [ 7]  242 	ld	(de), a
                            243 ;src/txt_scroll_hard.c:35: for (x=0;x<2;x++) {
   014D 04            [ 4]  244 	inc	b
   014E 78            [ 4]  245 	ld	a, b
   014F D6 02         [ 7]  246 	sub	a, #0x02
   0151 38 B8         [12]  247 	jr	C,00114$
                            248 ;src/txt_scroll_hard.c:34: for (y=0;y<8;y++) {
   0153 0C            [ 4]  249 	inc	c
   0154 79            [ 4]  250 	ld	a, c
   0155 D6 08         [ 7]  251 	sub	a, #0x08
   0157 38 B0         [12]  252 	jr	C,00126$
   0159                     253 00118$:
   0159 DD F9         [10]  254 	ld	sp, ix
   015B DD E1         [14]  255 	pop	ix
   015D C9            [10]  256 	ret
                            257 ;src/txt_scroll_hard.c:88: void scroll_hard(u16 step, u8* screen_plot_address) {
                            258 ;	---------------------------------
                            259 ; Function scroll_hard
                            260 ; ---------------------------------
   015E                     261 _scroll_hard::
   015E DD E5         [15]  262 	push	ix
   0160 DD 21 00 00   [14]  263 	ld	ix,#0
   0164 DD 39         [15]  264 	add	ix,sp
   0166 F5            [11]  265 	push	af
                            266 ;src/txt_scroll_hard.c:94: u8* plot=screen_plot_address;
   0167 DD 4E 06      [19]  267 	ld	c,6 (ix)
   016A DD 46 07      [19]  268 	ld	b,7 (ix)
                            269 ;src/txt_scroll_hard.c:97: div=step/8;
   016D DD 5E 04      [19]  270 	ld	e,4 (ix)
   0170 DD 56 05      [19]  271 	ld	d,5 (ix)
   0173 CB 3A         [ 8]  272 	srl	d
   0175 CB 1B         [ 8]  273 	rr	e
   0177 CB 3A         [ 8]  274 	srl	d
   0179 CB 1B         [ 8]  275 	rr	e
   017B CB 3A         [ 8]  276 	srl	d
   017D CB 1B         [ 8]  277 	rr	e
                            278 ;src/txt_scroll_hard.c:98: mod=step%8;
   017F DD 7E 04      [19]  279 	ld	a, 4 (ix)
   0182 E6 07         [ 7]  280 	and	a, #0x07
   0184 DD 77 FE      [19]  281 	ld	-2 (ix), a
   0187 DD 36 FF 00   [19]  282 	ld	-1 (ix), #0x00
                            283 ;src/txt_scroll_hard.c:99: div=div%128;
   018B CB BB         [ 8]  284 	res	7, e
   018D 16 00         [ 7]  285 	ld	d, #0x00
                            286 ;src/txt_scroll_hard.c:100: if (texte[div]==' ') {
   018F 21rF7r01      [10]  287 	ld	hl, #_texte+0
   0192 19            [11]  288 	add	hl, de
   0193 5E            [ 7]  289 	ld	e, (hl)
   0194 7B            [ 4]  290 	ld	a, e
   0195 D6 20         [ 7]  291 	sub	a, #0x20
   0197 20 05         [12]  292 	jr	NZ,00102$
                            293 ;src/txt_scroll_hard.c:101: o=0;
   0199 11 00 00      [10]  294 	ld	de, #0x0000
   019C 18 09         [12]  295 	jr	00103$
   019E                     296 00102$:
                            297 ;src/txt_scroll_hard.c:103: o=texte[div]-'?';
   019E 16 00         [ 7]  298 	ld	d, #0x00
   01A0 7B            [ 4]  299 	ld	a, e
   01A1 C6 C1         [ 7]  300 	add	a, #0xc1
   01A3 5F            [ 4]  301 	ld	e, a
   01A4 7A            [ 4]  302 	ld	a, d
   01A5 CE FF         [ 7]  303 	adc	a, #0xff
   01A7                     304 00103$:
                            305 ;src/txt_scroll_hard.c:106: pointeur=(u16)g_tile_fontmap32x32plat_000+o*8*(32*2)+mod*(32*2);
   01A7 21r00r00      [10]  306 	ld	hl, #_g_tile_fontmap32x32plat_000
   01AA 7B            [ 4]  307 	ld	a, e
   01AB 87            [ 4]  308 	add	a, a
   01AC 57            [ 4]  309 	ld	d, a
   01AD 1E 00         [ 7]  310 	ld	e, #0x00
   01AF 19            [11]  311 	add	hl,de
   01B0 EB            [ 4]  312 	ex	de,hl
   01B1 E1            [10]  313 	pop	hl
   01B2 E5            [11]  314 	push	hl
   01B3 29            [11]  315 	add	hl, hl
   01B4 29            [11]  316 	add	hl, hl
   01B5 29            [11]  317 	add	hl, hl
   01B6 29            [11]  318 	add	hl, hl
   01B7 29            [11]  319 	add	hl, hl
   01B8 29            [11]  320 	add	hl, hl
   01B9 19            [11]  321 	add	hl, de
                            322 ;src/txt_scroll_hard.c:110: draw_char(0,(u8*)pointeur, plot);
   01BA E5            [11]  323 	push	hl
   01BB C5            [11]  324 	push	bc
   01BC C5            [11]  325 	push	bc
   01BD E5            [11]  326 	push	hl
   01BE AF            [ 4]  327 	xor	a, a
   01BF F5            [11]  328 	push	af
   01C0 33            [ 6]  329 	inc	sp
   01C1 CDr00r00      [17]  330 	call	_draw_char
   01C4 F1            [10]  331 	pop	af
   01C5 F1            [10]  332 	pop	af
   01C6 33            [ 6]  333 	inc	sp
   01C7 C1            [10]  334 	pop	bc
   01C8 E1            [10]  335 	pop	hl
                            336 ;src/txt_scroll_hard.c:111: draw_char(1,(u8*)pointeur, plot);
   01C9 E5            [11]  337 	push	hl
   01CA C5            [11]  338 	push	bc
   01CB C5            [11]  339 	push	bc
   01CC E5            [11]  340 	push	hl
   01CD 3E 01         [ 7]  341 	ld	a, #0x01
   01CF F5            [11]  342 	push	af
   01D0 33            [ 6]  343 	inc	sp
   01D1 CDr00r00      [17]  344 	call	_draw_char
   01D4 F1            [10]  345 	pop	af
   01D5 F1            [10]  346 	pop	af
   01D6 33            [ 6]  347 	inc	sp
   01D7 C1            [10]  348 	pop	bc
   01D8 E1            [10]  349 	pop	hl
                            350 ;src/txt_scroll_hard.c:112: draw_char(2,(u8*)pointeur, plot);
   01D9 E5            [11]  351 	push	hl
   01DA C5            [11]  352 	push	bc
   01DB C5            [11]  353 	push	bc
   01DC E5            [11]  354 	push	hl
   01DD 3E 02         [ 7]  355 	ld	a, #0x02
   01DF F5            [11]  356 	push	af
   01E0 33            [ 6]  357 	inc	sp
   01E1 CDr00r00      [17]  358 	call	_draw_char
   01E4 F1            [10]  359 	pop	af
   01E5 F1            [10]  360 	pop	af
   01E6 33            [ 6]  361 	inc	sp
   01E7 C1            [10]  362 	pop	bc
   01E8 E1            [10]  363 	pop	hl
                            364 ;src/txt_scroll_hard.c:113: draw_char(3,(u8*)pointeur, plot);
   01E9 C5            [11]  365 	push	bc
   01EA E5            [11]  366 	push	hl
   01EB 3E 03         [ 7]  367 	ld	a, #0x03
   01ED F5            [11]  368 	push	af
   01EE 33            [ 6]  369 	inc	sp
   01EF CDr00r00      [17]  370 	call	_draw_char
   01F2 DD F9         [10]  371 	ld	sp,ix
   01F4 DD E1         [14]  372 	pop	ix
   01F6 C9            [10]  373 	ret
   01F7                     374 _texte:
   01F7 57 45 20 57 49 53   375 	.ascii "WE WISH YOU A MERRY CHRISTMAS WE WISH YOU A MERRY CHRISTMAS "
        48 20 59 4F 55 20
        41 20 4D 45 52 52
        59 20 43 48 52 49
        53 54 4D 41 53 20
        57 45 20 57 49 53
        48 20 59 4F 55 20
        41 20 4D 45 52 52
        59 20 43 48 52 49
        53 54 4D 41 53 20
   0233 41 4E 44 20 41 20   376 	.ascii "AND A HAPPY NEW YEAR FROM THSF AND TETALAB      AZERTYUIOPQS"
        48 41 50 50 59 20
        4E 45 57 20 59 45
        41 52 20 46 52 4F
        4D 20 54 48 53 46
        20 41 4E 44 20 54
        45 54 41 4C 41 42
        20 20 20 20 20 20
        41 5A 45 52 54 59
        55 49 4F 50 51 53
   026F 44 46 47 20 20 20   377 	.ascii "DFG     "
        20 20
   0277 00                  378 	.db 0x00
   0278 00                  379 	.db 0x00
                            380 	.area _CODE
                            381 	.area _INITIALIZER
                            382 	.area _CABS (ABS)
